{% extends "base.html" %}

{% block title %}{{ material.title }} - {{ material.brand.name }}{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style/material.css') }}">

<div class="material-header">
    <div class="material-header-content">
        <h1>{{ material.brand.name }}</h1>
        {% if current_user.is_authenticated and current_user.id == material.brand.user_id %}
        <a href="{{ url_for('edit_material', material_id=material.id) }}" class="btn btn-primary">
            <img src="{{ url_for('static', filename='images/edit.svg') }}" alt="Edit" class="btn-icon">
            Редагувати матеріал
        </a>
        {% endif %}
    </div>
</div>

<div class="container mt-4">
    <!-- Галерея изображений -->
    <div class="material-gallery mb-4">
        <!-- Главное изображение -->
        <div class="main-image-container mb-3">
            <img src="{{ url_for('static', filename='img/materials/' + (material.image_path or 'default.png')) }}" 
                 alt="{{ material.title }}" 
                 class="img-fluid main-image" 
                 id="mainImage">
        </div>
        
        <!-- Галерея миниатюр -->
        <div class="thumbnail-gallery">
            <!-- Главное изображение в галерее -->
            <div class="thumbnail-item active" onclick="changeMainImage(this)">
                <img src="{{ url_for('static', filename='img/materials/' + (material.image_path or 'default.png')) }}" 
                     alt="{{ material.title }}" 
                     class="img-thumbnail">
            </div>
            
            <!-- Дополнительные изображения -->
            {% if material.additional_images %}
                {% for image in material.additional_images %}
                <div class="thumbnail-item" onclick="changeMainImage(this)">
                    <img src="{{ url_for('static', filename='img/materials/' + image.image_path) }}" 
                         alt="{{ material.title }}" 
                         class="img-thumbnail">
                </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>

    <!-- Информация о материале -->
    <div class="material-content">
        <h1 class="material-title">{{ material.title }}</h1>
        <div class="material-meta">
            <span class="material-category">Категорія: {{ material.category.name }}</span>
        </div>
        <div class="material-description">
            {{ material.description|safe }}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .material-gallery {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .main-image-container {
        width: 100%;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f8f9fa;
        border-radius: 8px;
        overflow: hidden;
    }

    .main-image {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }

    .thumbnail-gallery {
        display: flex;
        gap: 10px;
        overflow-x: auto;
        padding: 10px 0;
    }

    .thumbnail-item {
        width: 100px;
        height: 100px;
        cursor: pointer;
        border: 2px solid transparent;
        border-radius: 4px;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .thumbnail-item:hover {
        border-color: #007bff;
    }

    .thumbnail-item.active {
        border-color: #007bff;
    }

    .thumbnail-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .material-content {
        background: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .material-title {
        font-size: 32px;
        margin-bottom: 20px;
        color: #333;
    }

    .material-meta {
        margin-bottom: 30px;
        color: #6c757d;
        font-size: 16px;
    }

    .material-description {
        font-size: 16px;
        line-height: 1.6;
        color: #444;
    }

    .material-description p {
        margin-bottom: 1em;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    function changeMainImage(element) {
        // Убираем активный класс у всех миниатюр
        document.querySelectorAll('.thumbnail-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // Добавляем активный класс выбранной миниатюре
        element.classList.add('active');
        
        // Обновляем главное изображение
        const mainImage = document.getElementById('mainImage');
        const thumbnailImage = element.querySelector('img');
        mainImage.src = thumbnailImage.src;
    }
</script>
{% endblock %} 